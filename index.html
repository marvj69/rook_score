<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Rook - Game Scoring Screen</title>
<meta name="theme-color" content="#ffffff">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="icon" href="icons/icon-192x192.png">
<script src="https://cdn.tailwindcss.com"></script>
<script>tailwind.config={darkMode:"class"}</script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<style>
@keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in{animation:fadeIn .5s ease-out}
.score-input-container{overflow:hidden;max-height:0;opacity:0;transform:translateY(-10px);transition:all .4s ease-in-out}
.score-input-container.show{max-height:1000px;opacity:1;transform:translateY(0)}
.focus-outline:focus{outline:2px dashed #3182ce;outline-offset:2px}
.no-scrollbar::-webkit-scrollbar{display:none}
.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
#saveIndicator{position:fixed;bottom:1rem;right:1rem;background-color:rgba(16,185,129,.7);color:#fff;padding:.5rem 1rem;border-radius:.375rem;box-shadow:0 2px 4px rgba(0,0,0,.1);opacity:0;transition:opacity .3s ease-in-out;pointer-events:none;z-index:1000;font-size:.875rem}
#saveIndicator.show{opacity:1}
.hamburger-menu{display:flex;flex-direction:column;cursor:pointer;position:fixed;top:20px;left:20px;z-index:1100;transition:all .3s ease}
.bar{width:30px;height:4px;background-color:#333;margin:5px 0;transition:all .3s}
html.dark .bar{background-color:#fff}
.hamburger-menu.open .bar:nth-child(1){transform:rotate(45deg) translate(10px,10px)}
.hamburger-menu.open .bar:nth-child(2){opacity:0}
.hamburger-menu.open .bar:nth-child(3){transform:rotate(-45deg) translate(10px,-10px)}
nav{position:fixed;top:0;left:-300px;width:250px;height:100%;background-color:#fff;z-index:1200;transition:left .3s ease;box-shadow:2px 0 5px rgba(0,0,0,.1)}
nav.show{left:0}
html.dark nav{background-color:#2d3748}
nav ul{list-style-type:none;padding:0;margin:0;margin-top:60px}
nav ul li{margin:0;border-bottom:1px solid #e0e0e0}
nav ul li:last-child{border-bottom:none}
nav ul li a,nav ul li button{color:#333;text-decoration:none;font-size:20px;padding:15px 20px;display:block;transition:background-color .3s ease;width:100%;text-align:left;background:none;border:none;cursor:pointer;font-family:inherit}
nav ul li a:hover,nav ul li button:hover{background-color:#f5f5f5}
html.dark nav ul li a,html.dark nav ul li button{color:#fff}
html.dark nav ul li a:hover,html.dark nav ul li button:hover{background-color:#4a5568}
.close-menu{position:absolute;top:20px;right:20px;color:#333;font-size:30px;cursor:pointer}
html.dark .close-menu{color:#fff}
.menu-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:1150;display:none}
.menu-overlay.show{display:block}
.modal{transition:opacity .25s ease}
.modal.hidden{display:none}
</style>
</head>
<body class="bg-white text-gray-800 min-h-screen transition-colors duration-300 dark:bg-gray-900 dark:text-gray-100">
<div class="hamburger-menu" onclick="toggleMenu(event)" aria-label="Open Menu" role="button" tabindex="0" id="hamburgerIcon">
  <div class="bar"></div><div class="bar"></div><div class="bar"></div>
</div>
<nav id="menu">
  <ul>
    <li><a href="#" onclick="openSavedGamesModal();toggleMenu(event)">View Saved Games</a></li>
    <li><a href="#" onclick="handleNewGame();toggleMenu(event)">New Game</a></li>
    <li><a href="#" onclick="handleFreezerGame();toggleMenu(event)">Freeze Game</a></li>
    <li>
      <button id="darkModeToggle" onclick="toggleDarkMode(event)" class="flex items-center focus:outline-none">
        <span id="darkModeIcon"></span>
        <span id="darkModeLabel" class="ml-2">Dark Mode</span>
      </button>
    </li>
  </ul>
</nav>
<div id="menuOverlay" class="menu-overlay" onclick="closeMenuOverlay()" aria-hidden="true"></div>
<div class="absolute top-0 right-0 m-4 p-2 text-gray-800 font-medium text-xs bg-white bg-opacity-70 rounded-full shadow px-3 py-1 dark:bg-gray-800 dark:text-gray-100" style="cursor:pointer" onclick="showEasterEgg()">
  <p>Version 1.1.2</p>
</div>
<div id="app" class="max-w-4xl mx-auto p-4 sm:p-6 space-y-6"></div>
<div id="saveIndicator" class="hidden">Saved</div>
<div id="savedGamesModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="savedGamesTitle">
  <div class="bg-white w-full max-w-4xl rounded-xl shadow-lg overflow-y-auto max-h-full dark:bg-gray-800">
    <div class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
      <h3 id="savedGamesTitle" class="text-2xl font-semibold text-gray-800 dark:text-gray-100">Saved Games</h3>
      <button id="closeSavedGamesModalBtn" class="text-gray-700 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-gray-300 dark:hover:text-gray-100" aria-label="Close Saved Games Modal">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div class="p-5 space-y-6">
      <div class="rounded-xl shadow-sm p-4 bg-gray-50 dark:bg-gray-700">
        <h4 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-100">Completed Games</h4>
        <div id="savedGamesList" class="space-y-4"></div>
      </div>
      <div class="rounded-xl shadow-sm p-4 bg-gray-50 dark:bg-gray-700">
        <h4 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-100">Freezer Games</h4>
        <div id="freezerGamesList" class="space-y-4"></div>
      </div>
    </div>
  </div>
</div>
<div id="saveGameModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="saveGameModalTitle">
  <div class="bg-white w-full max-w-md rounded-xl shadow-lg dark:bg-gray-800">
    <div class="p-6">
      <h2 id="saveGameModalTitle" class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">Save Game</h2>
      <form id="saveGameForm" class="space-y-4">
        <div>
          <label for="player1Name" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Player 1 (Us)</label>
          <input type="text" id="player1Name" name="player1Name" required class="mt-1 block w-full border border-gray-300 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-100" placeholder="Enter Player 1 Name">
        </div>
        <div>
          <label for="player2Name" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Player 2 (Dem)</label>
          <input type="text" id="player2Name" name="player2Name" required class="mt-1 block w-full border border-gray-300 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-100" placeholder="Enter Player 2 Name">
        </div>
        <div class="flex justify-end space-x-2">
          <button type="button" onclick="closeSaveGameModal()" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-xl hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:focus:ring-gray-500">Cancel</button>
          <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-blue-500 dark:hover:bg-blue-600 dark:focus:ring-blue-400">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div id="freezeGameModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="freezeGameModalTitle">
  <div class="bg-white w-full max-w-md rounded-xl shadow-lg dark:bg-gray-800">
    <div class="p-6">
      <h2 id="freezeGameModalTitle" class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">Freeze Game</h2>
      <form id="freezeGameForm" class="space-y-4">
        <div>
          <label for="freezeGameName" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Game Name</label>
          <input type="text" id="freezeGameName" name="freezeGameName" required class="mt-1 block w-full border border-gray-300 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-100" placeholder="Enter Freezer Game Name">
        </div>
        <div class="flex justify-end space-x-2">
          <button type="button" onclick="closeFreezeGameModal()" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-xl hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:focus:ring-gray-500">Cancel</button>
          <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-blue-500 dark:hover:bg-blue-600 dark:focus:ring-blue-400">Freeze</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="confirmationModalTitle">
  <div class="bg-white w-full max-w-md rounded-xl shadow-lg dark:bg-gray-800">
    <div class="p-6">
      <h2 id="confirmationModalTitle" class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">Confirm Action</h2>
      <p id="confirmationModalMessage" class="text-gray-700 dark:text-gray-300 mb-6">Are you sure you want to proceed?</p>
      <div class="flex justify-end space-x-2">
        <button type="button" id="cancelModalButton" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-xl hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:focus:ring-gray-500">Cancel</button>
        <button type="button" id="noModalButton" class="bg-yellow-600 text-white px-4 py-2 rounded-xl hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:bg-yellow-500 dark:hover:bg-yellow-600 dark:focus:ring-yellow-400">No</button>
        <button type="button" id="confirmModalButton" class="bg-red-600 text-white px-4 py-2 rounded-xl hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 dark:bg-red-500 dark:hover:bg-red-600 dark:focus:ring-red-400">Yes</button>
      </div>
    </div>
  </div>
</div>
<script>
"use strict";const Icons={AlertCircle:'<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><path d="M12 8v4m0 4h.01"/></svg>',Undo:'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M3 7v6h6M21 17a9 9 0 0 0-9-9c-2.5 0-4.75.9-6.5 2.4L3 11"/></svg>',Trash:'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>',Load:'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 11H6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2v-6a8.001 8.001 0 0115.356-2z"/></svg>',Sun:'<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m8.66-8.66h-1M4.34 12.66h-1m15.364 4.95l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg>',Moon:'<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>',Trophy:'<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 10V4h10v6M7 10l-1 12h12l-1-12M7 10h10m-5 12v-6"/></svg>'};const presetBids=[120,125,130,135,140,"other"],DEFAULT_STATE={rounds:[],biddingTeam:"",bidAmount:"",customBidValue:"",showCustomBid:false,enterBidderPoints:false,error:"",gameOver:false,winner:null,savedScoreInputStates:{us:null,Dem:null},lastBidAmount:null,lastBidTeam:null};let state={...DEFAULT_STATE},confettiTriggered=false,ephemeralCustomBid="",ephemeralPoints="",ACTIVE_GAME_KEY="activeGameState",DARK_MODE_KEY="darkModeEnabled",confirmationCallback=null,noCallback=null,cancelCallback=null;function toggleDarkMode(e){e.stopPropagation();const t=document.documentElement,a=t.classList.toggle("dark");localStorage.setItem(DARK_MODE_KEY,a),updateDarkModeButton(a),updateMetaThemeColor(a)}function updateDarkModeButton(e){const t=document.getElementById("darkModeIcon"),a=document.getElementById("darkModeLabel");t&&a&&(t.innerHTML=e?Icons.Sun:Icons.Moon,a.textContent=e?"Light Mode":"Dark Mode")}function initializeDarkMode(){const e=JSON.parse(localStorage.getItem(DARK_MODE_KEY));e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),updateDarkModeButton(e),updateMetaThemeColor(e)}function updateMetaThemeColor(e){const t=document.querySelector('meta[name="theme-color"]');t&&t.setAttribute("content",e?"#1a202c":"#ffffff")}const getLocalStorage=e=>JSON.parse(localStorage.getItem(e))||[],setLocalStorage=(e,t)=>localStorage.setItem(e,JSON.stringify(t));function showSaveIndicator(){const e=document.getElementById("saveIndicator");e&&(e.classList.remove("hidden"),e.classList.add("show"),setTimeout(()=>{e.classList.remove("show"),e.classList.add("hidden")},1e3))}function loadCurrentGameState(){const e=localStorage.getItem(ACTIVE_GAME_KEY);if(e)try{const t=JSON.parse(e);state={...state,...t},renderApp()}catch(t){console.error("Failed to parse saved game state:",t),localStorage.removeItem(ACTIVE_GAME_KEY)}}function saveCurrentGameState(){state.gameOver?localStorage.removeItem(ACTIVE_GAME_KEY):(localStorage.setItem(ACTIVE_GAME_KEY,JSON.stringify(state)),showSaveIndicator())}function deleteGame(e,t,a){const n=getLocalStorage(e);openConfirmationModal(`Are you sure you want to delete this ${a}?`,()=>{n.splice(t,1),setLocalStorage(e,n),renderSavedGames(),renderFreezerGames(),closeConfirmationModal()},()=>{closeConfirmationModal()},()=>{closeConfirmationModal()})}function bringHamburgerToFront(){document.getElementById("hamburgerIcon").style.zIndex="9999"}function toggleMenu(e){e.stopPropagation();const t=document.getElementById("menu"),a=document.getElementById("hamburgerIcon"),n=document.getElementById("menuOverlay"),r=t.classList.contains("show");r?(t.classList.remove("show"),a.classList.remove("open"),n.classList.remove("show")):(t.classList.add("show"),a.classList.add("open"),n.classList.add("show"),bringHamburgerToFront())}function closeMenuOverlay(){const e=document.getElementById("menu"),t=document.getElementById("hamburgerIcon"),a=document.getElementById("menuOverlay");e.classList.remove("show"),t.classList.remove("open"),a.classList.remove("show")}function closeSavedGamesModal(){document.getElementById("savedGamesModal").classList.add("hidden")}function openConfirmationModal(e,t,a,n){const r=document.getElementById("confirmationModal"),o=document.getElementById("confirmationModalMessage"),l=document.getElementById("confirmModalButton"),i=document.getElementById("noModalButton"),s=document.getElementById("cancelModalButton");o.textContent=e,confirmationCallback=t,noCallback=a,cancelCallback=n,r.classList.remove("hidden");const d=l.cloneNode(!0);l.parentNode.replaceChild(d,l);const c=i.cloneNode(!0);i.parentNode.replaceChild(c,i);const m=s.cloneNode(!0);s.parentNode.replaceChild(m,s),d.addEventListener("click",()=>{confirmationCallback&&confirmationCallback()}),c.addEventListener("click",()=>{noCallback&&noCallback()}),m.addEventListener("click",()=>{cancelCallback&&cancelCallback()})}function closeConfirmationModal(){document.getElementById("confirmationModal").classList.add("hidden"),confirmationCallback=null,noCallback=null,cancelCallback=null}document.addEventListener("keydown",function(e){const t=document.getElementById("confirmationModal");"Escape"===e.key&&(t&&!t.classList.contains("hidden")&&closeConfirmationModal(),closeSavedGamesModal(),closeSaveGameModal(),closeFreezeGameModal())});function updateState(e){state={...state,...e},renderApp()}function openSavedGamesModal(){renderSavedGames(),renderFreezerGames(),document.getElementById("savedGamesModal").classList.remove("hidden"),document.getElementById("savedGamesModal").focus()}function openSaveGameModal(){document.getElementById("saveGameModal").classList.remove("hidden")}function closeSaveGameModal(){document.getElementById("saveGameModal").classList.add("hidden"),document.getElementById("saveGameForm").reset()}function openFreezeGameModal(){document.getElementById("freezeGameModal").classList.remove("hidden")}function closeFreezeGameModal(){document.getElementById("freezeGameModal").classList.add("hidden"),document.getElementById("freezeGameForm").reset()}function handleTeamClick(e){if(state.gameOver)return;if(state.biddingTeam===e){state.savedScoreInputStates[e]={bidAmount:state.bidAmount,customBidValue:state.customBidValue,showCustomBid:state.showCustomBid,enterBidderPoints:state.enterBidderPoints,error:state.error},updateState({biddingTeam:"",bidAmount:"",showCustomBid:false,customBidValue:"",enterBidderPoints:false,error:""})}else{const t="us"===e?"Dem":"us";state.savedScoreInputStates[t]=null;let a={biddingTeam:e,bidAmount:"",showCustomBid:false,customBidValue:"",enterBidderPoints:false,error:""},n=state.savedScoreInputStates[e];n&&(a={...a,...n}),updateState(a)}ephemeralCustomBid="",ephemeralPoints=""}function handleBidSelect(e){"other"===e?(ephemeralCustomBid="",updateState({showCustomBid:true,bidAmount:"",customBidValue:""})):(ephemeralCustomBid="",updateState({showCustomBid:false,bidAmount:e.toString(),customBidValue:""})),"other"!==e?updateState({lastBidAmount:e.toString(),lastBidTeam:state.biddingTeam}):updateState({lastBidAmount:null,lastBidTeam:null})}function handleCustomBidChange(e){ephemeralCustomBid=e.target.value;const t=validateBid(ephemeralCustomBid);t?updateState({customBidValue:ephemeralCustomBid,bidAmount:"",lastBidAmount:null,lastBidTeam:null}):updateState({customBidValue:ephemeralCustomBid,bidAmount:ephemeralCustomBid,lastBidAmount:ephemeralCustomBid,lastBidTeam:state.biddingTeam})}function handleBiddingPointsToggle(e){ephemeralPoints="",updateState({enterBidderPoints:e})}function handleFormSubmit(e){e.preventDefault();const{biddingTeam:t,bidAmount:a,rounds:n,enterBidderPoints:r}=state,o=document.getElementById("pointsInput");if(!o)return void updateState({error:"Points input field not found."});const l=o.value;if(!t||!a)return void updateState({error:"Please enter a custom bid"});const i=validateBid(a),s=validatePoints(l);if(i||s)return void updateState({error:i||s});const d=Number(a),c=Number(l),m=r?c:360===c?360:180-c,f=360===c?0:180-m,u="us"===t?m<d?-d:m:f,g="Dem"===t?m<d?-d:m:f,h=n.length?n[n.length-1].runningTotals:{us:0,Dem:0},p={us:h.us+u,Dem:h.Dem+g},v=[...n,{biddingTeam:t,bidAmount:d,usPoints:u,DemPoints:g,runningTotals:p}],b="us"===t?u>=d&&u>0:g>=d&&g>0,y="us"===t?g<0:u<0,w=Math.abs(p.us-p.Dem),E=p.us>p.Dem?"us":"Dem",S=w>=1e3,T="us"===t?u<0:g<0;let C=false,L=null,x="";("us"===t&&p.us>=500||"Dem"===t&&p.Dem>=500)&&(b||y)?(C=true,L=t,x="reached 500 points"):T&&("us"===t?g>=500:p.us>=500)?(C=true,L="us"===t?"Dem":"us",x=`${"us"===t?"Dem":"us"} reached 500 points after ${"us"===t?"our team":"Dem team"} failed their bid`):S&&(C=true,L=E,x="a 1000-point spread"),ephemeralCustomBid="",ephemeralPoints="",C?(updateState({rounds:v,gameOver:C,winner:L,biddingTeam:"",bidAmount:"",showCustomBid:false,customBidValue:"",enterBidderPoints:false,error:""}),saveCurrentGameState()):(
updateState({rounds:v,biddingTeam:"",bidAmount:"",showCustomBid:false,customBidValue:"",enterBidderPoints:false,error:""}),saveCurrentGameState())}function handleUndo(){if(!state.rounds.length)return;const e=state.rounds.slice(0,-1);let t=null,a=null;if(e.length>0){const n=e[e.length-1];t=n.bidAmount.toString(),a=n.biddingTeam}updateState({rounds:e,gameOver:false,winner:null,lastBidAmount:t,lastBidTeam:a}),saveCurrentGameState()}function handleNewGame(){if(state.rounds.length>0)openConfirmationModal("Do you want to save the previous game result before starting a new game?",()=>{closeConfirmationModal(),openSaveGameModal()},()=>{closeConfirmationModal(),localStorage.removeItem(ACTIVE_GAME_KEY),ephemeralCustomBid="",ephemeralPoints="",updateState({...DEFAULT_STATE}),confettiTriggered=false},()=>{closeConfirmationModal()});else updateState({...DEFAULT_STATE})}function handleManualSaveGame(){state.rounds.length&&openSaveGameModal()}function handleFreezeGameModalSubmit(e){if(!e)return;const t=getLocalStorage("freezerGames");if(t.some(a=>a.name.toLowerCase()===e.toLowerCase()))return;const a=state.rounds[state.rounds.length-1],n=state.rounds.reduce((r,o)=>({us:r.us+o.usPoints,Dem:r.Dem+o.DemPoints}),{us:0,Dem:0});t.push({name:e,finalScore:{us:n.us,Dem:n.Dem},lastBid:a.bidAmount,rounds:state.rounds,timestamp:new Date().toISOString()}),setLocalStorage("freezerGames",t),localStorage.removeItem(ACTIVE_GAME_KEY),ephemeralCustomBid="",ephemeralPoints="",updateState({...DEFAULT_STATE}),confettiTriggered=false}function handleFreezerGame(){state.rounds.length&&openFreezeGameModal()}function handleSaveGameFormSubmit(e){e.preventDefault();const t=document.getElementById("player1Name").value.trim(),a=document.getElementById("player2Name").value.trim();if(!t||!a)return;const n=state.rounds.length?state.rounds[state.rounds.length-1].runningTotals:{us:0,Dem:0},r=getLocalStorage("savedGames");r.push({player1:t,player2:a,rounds:state.rounds,finalScore:n,timestamp:new Date().toISOString()}),setLocalStorage("savedGames",r),localStorage.removeItem(ACTIVE_GAME_KEY),ephemeralCustomBid="",ephemeralPoints="",updateState({...DEFAULT_STATE}),closeSaveGameModal(),confettiTriggered=false}function handleFreezeGameFormSubmit(e){e.preventDefault();const t=document.getElementById("freezeGameName").value.trim();handleFreezeGameModalSubmit(t),closeFreezeGameModal()}function loadFreezerGame(e){const t=getLocalStorage("freezerGames"),a=t[e];a&&openConfirmationModal(`Load the freezer game "${a.name}"? This will overwrite the current game.`,()=>{closeConfirmationModal(),updateState({rounds:a.rounds,gameOver:false,winner:null,biddingTeam:"",bidAmount:"",showCustomBid:false,customBidValue:"",enterBidderPoints:false,error:"",lastBidAmount:null,lastBidTeam:null}),t.splice(e,1),setLocalStorage("freezerGames",t),closeSavedGamesModal(),saveCurrentGameState(),confettiTriggered=false},()=>{closeConfirmationModal()},()=>{closeConfirmationModal()})}function renderSavedGames(){const e=getLocalStorage("savedGames"),t=document.getElementById("savedGamesList");e.length?t.innerHTML=e.map((a,n)=>`<div class="border p-4 rounded-xl shadow-sm bg-gray-50 dark:bg-gray-700"><div class="flex justify-between items-center"><div><p class="font-semibold text-gray-800 dark:text-gray-100">Players:</p><p>${a.player1} vs ${a.player2}</p></div><button onclick="deleteSavedGame(${n})" class="text-red-600 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 dark:text-red-400 dark:hover:text-red-600" aria-label="Delete Saved Game">${Icons.Trash}</button></div><div class="mt-2"><p class="font-semibold text-gray-800 dark:text-gray-100">Final Score:</p><p>Us: ${a.finalScore.us} | Dem: ${a.finalScore.Dem}</p></div><div class="mt-2"><p class="font-semibold text-gray-800 dark:text-gray-100">Date:</p><p>${new Date(a.timestamp).toLocaleString()}</p></div></div>`).join(""):t.innerHTML='<p class="text-gray-600 dark:text-gray-300">No completed games available.</p>'}function renderFreezerGames(){const e=getLocalStorage("freezerGames"),t=document.getElementById("freezerGamesList");e.length?t.innerHTML=e.map((a,n)=>`<div class="border p-4 rounded-xl shadow-sm bg-gray-50 dark:bg-gray-700"><div class="flex justify-between items-center"><div><p class="font-semibold text-gray-800 dark:text-gray-100">Name:</p><p>${a.name}</p></div><div class="flex space-x-2"><button onclick="loadFreezerGame(${n})" class="text-blue-600 hover:text-blue-800 flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-blue-400 dark:hover:text-blue-600" aria-label="Load Freezer Game">${Icons.Load}Load</button><button onclick="deleteFreezerGame(${n})" class="text-red-600 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 dark:text-red-400 dark:hover:text-red-600" aria-label="Delete Freezer Game">${Icons.Trash}</button></div></div><div class="mt-2"><p class="font-semibold text-gray-800 dark:text-gray-100">Final Score:</p><p>Us: ${a.finalScore.us} | Dem: ${a.finalScore.Dem}</p></div><div class="mt-2"><p class="font-semibold text-gray-800 dark:text-gray-100">Last Bid:</p><p>${a.lastBid}</p></div><div class="mt-2"><p class="font-semibold text-gray-800 dark:text-gray-100">Date Frozen:</p><p>${new Date(a.timestamp).toLocaleString()}</p></div></div>`).join(""):t.innerHTML='<p class="text-gray-600 dark:text-gray-300">No freezer games available.</p>'}function deleteSavedGame(e){deleteGame("savedGames",e,"saved game")}function deleteFreezerGame(e){deleteGame("freezerGames",e,"freezer game")}function renderTeamCard(e,t,a){const n=state.biddingTeam===e,r=n?`bg-${a}-900 text-white`:`bg-${a}-500 text-white`;return`<div class="${r} cursor-pointer hover:${r} transition-colors rounded-xl shadow-md flex items-center justify-center w-32 h-32" onclick="handleTeamClick('${e}')" tabindex="0" role="button" aria-pressed="${n}" aria-label="Select ${"us"===e?"Our Team":"Dem Team"}"><div class="flex flex-col items-center"><h2 class="text-xl font-semibold capitalize">${"us"===e?"Us":"Dem"}</h2><p class="text-2xl font-bold">${t}</p></div></div>`}function renderRoundCard(e,t){return`<div class="bg-white rounded-xl border border-gray-200 shadow flex flex-col items-center justify-center p-4 flex-1 min-w-0 w-48 h-32 dark:bg-gray-800 dark:border-gray-700"><div class="text-center space-y-1"><h2 class="text-xl font-bold text-gray-700 dark:text-gray-100">Round</h2><p class="text-2xl font-extrabold text-gray-900 dark:text-gray-100">${e}</p>${t}</div></div>`}function renderErrorAlert(e){return`<div role="alert" class="flex items-center border border-red-400 rounded-xl p-4 bg-red-50 text-red-700 space-x-3 dark:bg-red-700 dark:border-red-600 dark:text-red-100"><div class="flex-shrink-0">${Icons.AlertCircle}</div><div class="flex-1">${e}</div></div>`}function renderPointsInput(){const{biddingTeam:e,enterBidderPoints:t}=state,a="us"===e?t?"Our Points (Bidding Team)":"Dem Points (Non-Bidding Team)":t?"Dem Points (Bidding Team)":"Our Points (Non-Bidding Team)",n="Dem"===e?"red":"blue",r="Dem"!==e?"red":"blue",o=t?`bg-${n}-600 text-white shadow hover:bg-${n}-700 dark:bg-${n}-700 dark:hover:bg-${n}-800`:`bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-500`,l=!t?`bg-${r}-600 text-white shadow hover:bg-${r}-700 dark:bg-${r}-700 dark:hover:bg-${r}-800`:`bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-500`;return`<div class="space-y-6"><div><label for="pointsToggle" class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-200">Enter Points For</label><div class="flex gap-4"><button type="button" class="flex-1 rounded-full px-4 py-2 text-sm font-medium ${o} transition focus:outline-none focus:ring-2 focus:ring-${n}-500 focus:ring-opacity-50" onclick="handleBiddingPointsToggle(true)" aria-pressed="${t}">Bidding Team</button><button type="button" class="flex-1 rounded-full px-4 py-2 text-sm font-medium ${l} transition focus:outline-none focus:ring-2 focus:ring-${r}-500 focus:ring-opacity-50" onclick="handleBiddingPointsToggle(false)" aria-pressed="${!t}">Non-Bidding Team</button></div></div><div><label for="pointsInput" class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-200">${a}</label><div class="flex flex-col sm:flex-row sm:items-center sm:gap-4"><input id="pointsInput" type="number" inputmode="numeric" pattern="[0-9]*" min="0" max="360" placeholder="Enter points" class="w-full sm:w-1/2 border border-gray-300 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition dark:bg-gray-600 dark:border-gray-500 dark:text-gray-100 dark:focus:ring-blue-400" aria-label="Enter Points"/><button type="submit" class="mt-4 sm:mt-0 bg-blue-600 text-white px-6 py-2 rounded-xl shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition dark:bg-blue-500 dark:hover:bg-blue-600 dark:focus:ring-blue-400">Submit</button></div></div></div>`}function renderScoreInputCard(){const{biddingTeam:e,bidAmount:t,customBidValue:a,showCustomBid:n,rounds:r,gameOver:o}=state;if(o||!e)return"";const l=t||n;return`<div class="bg-white border border-gray-200 rounded-lg shadow-lg dark:bg-gray-800 dark:border-gray-700"><div class="border-b border-gray-200 p-5 flex justify-between items-center dark:border-gray-700"><h2 class="text-xl font-bold text-gray-800 dark:text-gray-100">Score Input for ${"us"===e?"Our Team":"Dem Team"}</h2><button class="flex items-center border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 hover:bg-gray-200 transition disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-700 dark:focus:ring-blue-400" onclick="handleUndo(event)" ${!r.length?"disabled":""} title="Undo Last Round" aria-label="Undo Last Round">${Icons.Undo}Undo</button></div><div class="p-6 score-input-container ${e?"show":""}"><form onsubmit="handleFormSubmit(event)" class="space-y-6"><div><label for="bidAmount" class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-200">Bid Amount</label><div class="flex flex-wrap gap-3">${presetBids.map(s=>{const d="other"===s?n:t===String(s),c=d?"bg-blue-600 text-white shadow hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 dark:bg-gray-600 dark:border-gray-500 dark:text-gray-200 dark:hover:bg-gray-500",m="other"===s?"rounded-full":"rounded-lg";return`<button type="button" class="px-4 py-2 text-sm font-medium ${c} ${m} transition focus:outline-none focus:ring-2 focus:ring-blue-500 dark:ring-blue-400" onclick="handleBidSelect('${s}')" aria-pressed="${d}" aria-label="Select Bid ${"other"===s?"Other":s}">${"other"===s?"Other":s}</button>`}).join("")}${n?`<div class="mt-4 flex flex-col sm:flex-row sm:items-center sm:gap-4"><input type="number" inputmode="numeric" pattern="[0-9]*" step="5" value="${a}" onchange="handleCustomBidChange(event)" placeholder="Enter custom bid" class="w-full sm:w-1/2 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition dark:bg-gray-600 dark:border-gray-500 dark:text-gray-100 dark:focus:ring-blue-400" aria-label="Custom Bid Amount"/><span class="text-sm text-gray-500 dark:text-gray-300">Must be divisible by 5 (≤180 or 360)</span></div>`:""}</div></div>${l?renderPointsInput():""}</form></div></div>`}function renderHistoryCard(){const{rounds:e}=state;return`<div class="bg-white border border-gray-200 rounded-xl shadow dark:bg-gray-800 dark:border-gray-700"><div class="border-b border-gray-200 p-4 dark:border-gray-700"><h2 class="text-lg font-bold text-gray-800 dark:text-gray-100">History</h2><div class="grid grid-cols-3 gap-2 pt-3 font-medium text-gray-600 dark:text-gray-300 text-sm sm:text-base"><div class="text-left">Us</div><div class="text-center">Bid</div><div class="text-right">Dem</div></div></div><div class="p-4"><div class="space-y-2">${
e.map((t,a)=>{const n="us"===t.biddingTeam?`<span class="text-gray-800 dark:text-gray-100">←</span><span class="ml-1">${t.bidAmount}</span>`:`<span class="mr-1">${t.bidAmount}</span><span class="text-gray-800 dark:text-gray-100">→</span>`;return`<div key="${a}" class="grid grid-cols-3 gap-2 p-2 bg-gray-50 rounded-xl dark:bg-gray-700"><div class="text-left text-gray-800 dark:text-gray-100 font-semibold">${t.runningTotals.us}</div><div class="flex items-center justify-center">${n}</div><div class="text-right text-gray-800 dark:text-gray-100 font-semibold">${t.runningTotals.Dem}</div></div>`}).join("")
}</div></div></div>`}function renderGameOverOverlay(){if(!state.gameOver)return"";const{winner:e}=state;return`<div class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-md flex items-center justify-center p-4" role="alertdialog" aria-labelledby="gameOverTitle" aria-modal="true"><div class="bg-white w-full max-w-md rounded-xl shadow-lg dark:bg-gray-800"><div class="p-6 text-center"><h2 id="gameOverTitle" class="text-3xl font-bold mb-4 animate-fade-in text-gray-800 dark:text-gray-100 flex items-center justify-center">${Icons.Trophy}Game Over!</h2><p class="text-xl mb-6 animate-fade-in text-gray-700 dark:text-gray-300">${"us"===e?"Our Team Wins!":"Dem Team Wins!"}</p><button onclick="handleNewGame()" class="bg-blue-600 text-white px-6 py-3 rounded-xl shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition dark:bg-blue-500 dark:hover:bg-blue-600 dark:focus:ring-blue-400">New Game</button></div></div></div>`}function renderApp(){const{error:e,rounds:t,lastBidAmount:a,lastBidTeam:n,gameOver:r}=state,o=t.reduce((l,i)=>({us:l.us+i.usPoints,Dem:l.Dem+i.DemPoints}),{us:0,Dem:0}),l=t.length+1;let i="";if(a&&n){const s="us"===n?"←":"→";i=`<div class="mt-2 flex items-center justify-center space-x-1 text-gray-700 dark:text-gray-300"><span class="font-medium">Bid:</span><span>${a}</span><span>${s}</span></div>`}document.getElementById("app").innerHTML=`
<div class="text-center space-y-2">
  <div class="flex flex-col items-center">
    <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 dark:text-gray-100">Rook!</h1>
  </div>
  <p class="text-md sm:text-lg text-gray-600 dark:text-gray-300">Tap a team to start a bid!</p>
</div>
<div class="flex flex-row space-x-4 flex-wrap justify-center">
  ${renderTeamCard("us",o.us,"blue")}
  ${renderRoundCard(l,i)}
  ${renderTeamCard("Dem",o.Dem,"red")}
</div>
${e?`<div>${renderErrorAlert(e)}</div>`:""}
${renderScoreInputCard()}
${renderHistoryCard()}
${renderGameOverOverlay()}
`;r&&!confettiTriggered&&(confettiTriggered=true,confetti({particleCount:200,spread:70,origin:{y:.6}}))}function validateBid(e){const t=Number(e);return isNaN(t)?"Bid must be a number.":t<=0?"Bid must be greater than zero.":t%5!=0?"Bid must be divisible by 5.":t>360?"Bid cannot exceed 360.":""}function validatePoints(e){const t=Number(e);return isNaN(t)?"Points must be a number.":t<0||t>360?"Points must be between 0 and 360.":""}function showEasterEgg(){alert("Added Dark Mode functionallity, fixed logic bugs, improved user experience, increased efficiency")}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("closeSavedGamesModalBtn");e&&e.addEventListener("click",closeSavedGamesModal);const t=document.getElementById("saveGameForm");t&&t.addEventListener("submit",handleSaveGameFormSubmit);const a=document.getElementById("freezeGameForm");a&&a.addEventListener("submit",handleFreezeGameFormSubmit),loadCurrentGameState(),initializeDarkMode(),renderApp()});
</script>
</body>
</html>
